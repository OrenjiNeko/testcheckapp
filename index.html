<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Redirection</title>
    <style>
        #popup {
            display: none; /* Default: tidak muncul */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .popup-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .popup-content button {
            margin: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn-primary { background: #007BFF; color: white; }
        .btn-secondary { background: #6C757D; color: white; }
    </style>
</head>
<body>

    <div id="popup">
        <div class="popup-content">
            <p>Buka aplikasi atau tetap di halaman ini?</p>
            <button class="btn-primary" id="btnOpenApp">Menuju Aplikasi</button>
            <button class="btn-secondary" id="btnStay">Tetap di Sini</button>
        </div>
    </div>

    <iframe style="display:none" id="loader"></iframe>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var isiOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
            var isAndroid = /Android/.test(navigator.userAgent);

            if (isiOS || isAndroid) {
                document.getElementById("popup").style.display = "flex";
                
                document.getElementById("btnOpenApp").addEventListener("click", function () {
                    var appURL = "custom-protocol://my-app" + window.location.search + window.location.hash;
                    var fallbackLink = isAndroid 
                        ? "https://play.google.com/store/apps/details?id=com.swift.mobile"
                        : "itms-apps://itunes.apple.com/app/my-app/idxxxxxxxx?mt=8";

                    document.getElementById("loader").src = appURL;
                    
                    setTimeout(function () {
                        window.location.href = fallbackLink;
                    }, 1500);
                });

                document.getElementById("btnStay").addEventListener("click", function () {
                    document.getElementById("popup").style.display = "none";
                });
            }
        });
    </script>

</body>
</html>
